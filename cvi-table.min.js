function getTable(){return document.getElementById("cviTable")}function getTableBody(){return getTable().getElementsByTagName("tbody")[0]}function exportInfo(){var e=getTableBody();var t=[];var n,a,r,o,l,i;for(n=0,a=e.rows.length;n<a;n++){l=[];l.push(e.rows[n].cells[1].innerHTML);for(r=2,o=e.rows[n].cells.length-1;r<o;r++)l.push(parseInt(e.rows[n].cells[r].innerHTML));t.push(l)}i=new Blob([JSON.stringify(t)],{type:"application/json;charset=utf-8"});saveAs(i,"cvi-data.json")}function triggerDownload(e,t){var n=new MouseEvent("click",{view:window,bubbles:false,cancelable:true});var a=document.createElement("a");a.setAttribute("download",t);a.setAttribute("href",e);a.setAttribute("target","_blank");a.dispatchEvent(n)}function exportImage(){if(!cviRender){alert("No image has been rendered.");return}var e=document.getElementById("imageFormat").value;if(e=="SVG"){var t=new Blob([cviRender.svg.svg()],{type:"image/svg+xml;charset=utf-8"});saveAs(t,"cvi-image.svg")}else if(e=="PNG"||e=="JPG"){var n=document.getElementById("canvas");n.width=cviRender.svg.width();n.height=cviRender.svg.height();var a=n.getContext("2d");var r=cviRender.svg.svg();var o=window.URL||window.webkitURL||window;var l=new Image;var i=new Blob([r],{type:"image/svg+xml;charset=utf-8"});var d=o.createObjectURL(i);var c="image/png";var s="cvi-image";if(e=="JPG"){c="image/jpeg";s=s+".jpg"}else if(e=="PNG"){c="image/png";s=s+".png"}l.onload=function(){a.drawImage(l,0,0);o.revokeObjectURL(d);var e=n.toDataURL(c).replace(c,"image/octet-stream");triggerDownload(e,s)};l.src=d}else{alert("Unknown Image Format.")}}function loadTestData(){var e=[["Mark Nicholson T",14,21,29,8],["Karen Nicholson T",16,29,14,13]];for(var t in e){__addTableRow(e[t])}}function fileUpload(){var e,t,n,a;var r=document.getElementById("uploadFile");var o=r.files;for(a=0;a<o.length;a++){t=o[a];n=new FileReader;n.readAsText(t,"UTF-8");n.onload=function(n){try{e=JSON.parse(n.target.result);for(var a in e){__addTableRow(e[a])}}catch(e){alert("Failed to parse file '"+t.name+"': "+e);return}};n.onerror=function(e){alert("error reading file");return}}r.value=null}function delAllRows(){var e=getTableBody();for(var t=e.rows.length-1;t>=0;t--)e.deleteRow(t);tableScan()}function delRow(e){var t=getTableBody();var n=document.getElementById(e);t.deleteRow(n.rowIndex-1);tableScan()}function addTableRow(){console.log("addTableRow()");var e,t,n;var a=[];var r=[];var o=["newName","newBuilder","newMerchant","newInnovator","newBanker"];for(e in o){t=document.getElementById(o[e]);if(t&&t.value){a.push(t.value);continue}r.push(o[e].slice(3,20))}if(a.length<o.length){n="";if(r.length>1)n="s";alert("Cannot add row. '{0}' parameter{1} not provided.".format(r,n));return}console.log("Params"+a.toString());__addTableRow(a);for(e in o){t=document.getElementById(o[e]);t.value=""}}var rowID=3333;function uniqueRowID(){return"cviRow"+rowID++}function __addTableRow(e){var t=getTableBody();var n,a,r,o;n=t.insertRow(t.rows.length);n.id=uniqueRowID();a=n.insertCell(0);r=document.createElement("input");r.type="checkbox";r.onclick=tableScan;a.appendChild(r);a=n.insertCell(1);a.appendChild(document.createTextNode(e[0]));a=n.insertCell(2);a.appendChild(document.createTextNode(e[1]));a=n.insertCell(3);a.appendChild(document.createTextNode(e[2]));a=n.insertCell(4);a.appendChild(document.createTextNode(e[3]));a=n.insertCell(5);a.appendChild(document.createTextNode(e[4]));a=n.insertCell(6);o=document.createElement("button");o.onclick=function(){delRow(n.id)};o.innerHTML="&times;";a.appendChild(o)}function tableScan(){var e=[];var t=document.getElementById("cviTable");var n="Meeting";var a,r,o,l,i,d;for(r=1,a=t.rows.length;r<a;r++){i=[];if(!t.rows[r].cells[0].childNodes[0].checked)continue;i.push(t.rows[r].cells[1].innerHTML);for(o=2,l=4;l>0;o++,l--){i.push(parseInt(t.rows[r].cells[o].innerHTML))}e.push(i)}if(e.length>0){cviTool(n,e)}else{d=document.getElementById("svgDivID");while(d.childElementCount>0)d.removeChild(d.firstChild)}}
