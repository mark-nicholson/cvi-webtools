if(!String.prototype.format){String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(i,n){return typeof t[n]!="undefined"?t[n]:i})}}class t{constructor(t,i){this._x=t;this._y=i;this.ox=0;this.oy=0;this.scale=1}copy(){var i=new t(this._x,this._y);i.ox=this.ox;i.oy=this.oy;i.scale=this.scale;return i}getOrigin(){return[this.ox,this.oy]}setOrigin(t,i){this.ox=t;this.oy=i}setScale(t){this.scale=t}x(){return this._x*this.scale+this.ox}y(){return this._y*this.scale+this.oy}toString(){return"[{0},{1}] s={2}, o:[{3},{4}] -> [{5},{6}]".format(this._x,this._y,this.scale,this.ox,this.oy,this.x(),this.y())}dump(){console.log(this.toString())}}class i{constructor(i,n){if(i.ox!=n.ox||i.oy!=n.oy){return null}this.p1=i;this.p2=n;this.m=(this.p2.y()-this.p1.y())/(this.p2.x()-this.p1.x());this.b=this.p2.y()-this.m*this.p2.x();this.x_intercept=new t(-this.b/this.m,0);this.y_intercept=new t(0,this.m*0+this.b)}toString(){return"y = {0}x + {1}  xi:[{2},{3}]  yi:[{4},{5}]".format(this.m,this.b,this.x_intercept.x(),this.x_intercept.y(),this.y_intercept.x(),this.y_intercept.y())}dump(){console.log(this.toString())}xIntercept(){return this.x_intercept.copy()}yIntercept(){return this.y_intercept.copy()}}class n{constructor(t,i,n,e,o){this.name=t;this.merchant=i;this.innovator=n;this.banker=e;this.builder=o;this.intuitiveType=this.builder+this.merchant;this.independentType=this.builder+this.innovator;this.practicalType=this.builder+this.banker;this.creativeType=this.merchant+this.innovator;this.communityType=this.merchant+this.banker;this.cognitiveType=this.innovator+this.banker}merchantPoint(){return new t(this.merchant,-this.merchant)}innovatorPoint(){return new t(this.innovator,this.innovator)}builderPoint(){return new t(-this.builder,-this.builder)}bankerPoint(){return new t(-this.banker,this.banker)}merchantBuilderLine(){return new i(this.merchantPoint(),this.builderPoint())}builderBankerLine(){return new i(this.builderPoint(),this.bankerPoint())}bankerInnovatorLine(){return new i(this.bankerPoint(),this.innovatorPoint())}innovatorMerchantLine(){return new i(this.innovatorPoint(),this.merchantPoint())}merchantPoints(){return[this.merchantBuilderLine().yIntercept(),this.merchantPoint(),this.innovatorMerchantLine().xIntercept()]}innovatorPoints(){return[this.innovatorMerchantLine().xIntercept(),this.innovatorPoint(),this.bankerInnovatorLine().yIntercept()]}builderPoints(){return[this.merchantBuilderLine().yIntercept(),this.builderPoint(),this.builderBankerLine().xIntercept()]}bankerPoints(){return[this.bankerInnovatorLine().yIntercept(),this.bankerPoint(),this.builderBankerLine().xIntercept()]}}n.maxScore=30;class e extends n{constructor(t,i){var n,e=0,o=0,s=0,r=0;for(n in i){var h=i[n];o+=h.merchant;e+=h.innovator;s+=h.banker;r+=h.builder}super(t,o/i.length,e/i.length,s/i.length,r/i.length);this.profiles=i}}class o{constructor(i){this.canvasID=i;this.canvas=document.getElementById("cviCanvas");this.ctx=this.canvas.getContext("2d");this.ctx.width=this.canvas.width;this.ctx.height=this.canvas.height;this.scale=this.canvas.width/2/n.maxScore;this.origin=new t(this.canvas.width/2,this.canvas.height/2)}merchantQuadrantInfo(){return{quadrant:[1,-1],points:[],title:"Merchant","core-value":"Love","fill-colour":["#345AA3","#D5DDEC"],"title-location":[.9,.05]}}innovatorQuadrantInfo(){return{quadrant:[1,1],points:[],title:"Innovator","core-value":"Wisdom","fill-colour":["#D55EEA","#F6DCFB"],"title-location":[.9,.95]}}bankerQuadrantInfo(){return{quadrant:[-1,1],points:[],title:"Banker","core-value":"Knowledge","fill-colour":["#32842D","#C1DCBF"],"title-location":[.1,.95]}}builderQuadrantInfo(){return{quadrant:[-1,-1],points:[],title:"Builder","core-value":"Power","fill-colour":["#F03230","#FBC9C8"],"title-location":[.1,.05]}}_get_quadrants(t){var i=[this.merchantQuadrantInfo(),this.innovatorQuadrantInfo(),this.bankerQuadrantInfo(),this.builderQuadrantInfo()];if(!t)return i;i[0].points=t.merchantPoints();i[1].points=t.innovatorPoints();i[2].points=t.bankerPoints();i[3].points=t.builderPoints();for(var n in i){var e=i[n].points;for(var o in e){e[o].setOrigin(this.origin.x(),this.origin.y());e[o].setScale(this.scale)}}return i}renderQuandrantBackgrounds(){var t,i;var n=o.quadrantBackgroundColour;var e=this._get_quadrants(null);for(t in e){i=e[t].quadrant;this.ctx.beginPath();this.ctx.rect(this.canvas.width/2+3*i[0],this.canvas.height/2+3*i[1],this.canvas.width/2*i[0],this.canvas.height/2*i[1]);this.ctx.fillStyle=n;this.ctx.closePath();this.ctx.fill()}}renderTextLayer(t){var i,n;var e=".cviCanvas.quadrant-background-colour";var o=this._get_quadrants(null);var s,r,h,a;for(i in o){n=o[i];a=n["title"].toLowerCase();h=n["title"]+" ";if(Number.isInteger(t[a]))h+=t[a];else h+=t[a].toFixed(2);s=this.canvas.width*n["title-location"][0];r=this.canvas.height*n["title-location"][1];this.ctx.font="20px Arial";this.ctx.fillStyle="black";this.ctx.textAlign="center";this.ctx.fillText(h,s,r);this.ctx.font="16px Arial";this.ctx.fillText("["+n["core-value"]+"]",s,r+20)}}renderReferencePoints(t){var i,n;for(i in t){n=t[i];this.ctx.beginPath();this.ctx.arc(n.x(),n.y(),2,0,2*Math.PI,false);this.ctx.fillStyle="black";this.ctx.closePath();this.ctx.fill()}}renderPolygon(t,i){var n,e,o;n=this.ctx.createLinearGradient(this.origin.x(),this.origin.y(),t["points"][1].x(),t["points"][1].y());n.addColorStop(0,t["fill-colour"][1]);n.addColorStop(1,t["fill-colour"][0]);this.ctx.beginPath();this.ctx.fillStyle=n;this.ctx.moveTo(this.origin.x(),this.origin.y());for(e in t["points"]){o=t["points"][e];this.ctx.lineTo(o.x(),o.y())}this.ctx.closePath();this.ctx.fill();if(i){this.ctx.beginPath();console.log("Points: %s",t["points"].length);console.log("Border: [%s,%s] -> [%s,%s]",t["points"][0].x(),t["points"][0].y(),t["points"][1].x(),t["points"][1].y());this.ctx.moveTo(t["points"][0].x(),t["points"][0].y());this.ctx.lineTo(t["points"][1].x(),t["points"][1].y());this.ctx.lineWidth=3;this.ctx.strokeStyle="#afafaf";this.ctx.closePath();this.ctx.stroke();console.log("Border: [%s,%s] -> [%s,%s]",t["points"][1].x(),t["points"][1].y(),t["points"][2].x(),t["points"][2].y());this.ctx.beginPath();this.ctx.lineWidth=3;this.ctx.strokeStyle="#afafaf";this.ctx.moveTo(t["points"][1].x(),t["points"][1].y());this.ctx.lineTo(t["points"][2].x(),t["points"][2].y());this.ctx.closePath();this.ctx.stroke()}}render(t){var i,o,s,r;var h,a;var c;if(t instanceof e){console.log("Is a CVIGroupProfile");a=[];for(i in t.profiles)a.push(t.profiles[i]);a.push(t);c=t}else if(t instanceof n){console.log("Is a CVIProfile");a=[];c=t}else{c=t.shift();a=t}this.renderQuandrantBackgrounds();for(i in a){h=a[i];console.log("Rendering: "+h.name);s=this._get_quadrants(h);for(o in s){r=s[o];this.renderPolygon(r,false);this.renderReferencePoints(r["points"])}}var l=a.length!=0;s=this._get_quadrants(c);for(o in s){r=s[o];this.renderPolygon(r,l);this.renderReferencePoints(r["points"])}this.renderTextLayer(c);this.renderCoordinateLines()}renderCoordinateLines(){var t=this.ctx;var i=this.canvas;t.beginPath();t.moveTo(i.width/2,0);t.lineTo(i.width/2,i.height);t.lineWidth=6;t.strokeStyle="white";t.stroke();t.moveTo(0,i.height/2);t.lineTo(i.width,i.height/2);t.stroke()}}o.quadrantBackgroundColour="#E6E6E6";function cvi(t){"use strict";var i=new n("Mark Nicholson",21,29,8,14);var s=new n("Karen Nicholson",29,14,13,16);var r=new e("Nicholsons",[i,s]);var h;if(t=="karen")h=s;else if(t=="mark")h=i;else h=r;var a=new o("cviCanvas");a.render(h);return}function cviTool(t,i){if(!i||i.length==0)return;var s=new o("cviCanvas");var r=[];for(f in i){console.log(i[f]);var h=new n(i[f][0],i[f][1],i[f][2],i[f][3],i[f][4]);r.push(h);console.log("Profile: %s",h.toString())}if(r.length==1){s.render(r[0]);return}console.log("%s: %s",t,r);var a=new e(t,r);s.render(a)}class s{constructor(){this.cons_var=2}}s.myStaticProperty="yes";function cvi_test(){var t="15";var i;var n=new s;console.log("con_var: "+n.cons_var);console.log("staticProp: "+s.myStaticProperty)}
