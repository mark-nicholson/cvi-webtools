"use strict";if(!String.prototype.format){String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(i,n){return typeof t[n]!="undefined"?t[n]:i})}}class t{constructor(t,i){this._x=t;this._y=i;this.ox=0;this.oy=0;this.scale=1}copy(){var i=new t(this._x,this._y);i.ox=this.ox;i.oy=this.oy;i.scale=this.scale;return i}getOrigin(){return[this.ox,this.oy]}setOrigin(t,i){this.ox=t;this.oy=i}setScale(t){this.scale=t}x(){return this._x*this.scale+this.ox}y(){return this._y*this.scale+this.oy}toString(){return"[{0},{1}] s={2}, o:[{3},{4}] -> [{5},{6}]".format(this._x,this._y,this.scale,this.ox,this.oy,this.x(),this.y())}dump(){console.log(this.toString())}}class i{constructor(i,n){if(i.ox!=n.ox||i.oy!=n.oy){return null}this.p1=i;this.p2=n;if(this.p2.x()-this.p1.x()==0){this.x_intercept=new t(this.p1.x(),0);this.y_intercept=new t(0,NaN)}else{this.m=(this.p2.y()-this.p1.y())/(this.p2.x()-this.p1.x());this.b=this.p2.y()-this.m*this.p2.x();this.x_intercept=new t(-this.b/this.m,0);this.y_intercept=new t(0,this.m*0+this.b)}}toString(){return"y = {0}x + {1}  xi:[{2},{3}]  yi:[{4},{5}]".format(this.m,this.b,this.x_intercept.x(),this.x_intercept.y(),this.y_intercept.x(),this.y_intercept.y())}dump(){console.log(this.toString())}xIntercept(){return this.x_intercept.copy()}yIntercept(){return this.y_intercept.copy()}}class n{constructor(t,i,n,r,e){this.name=t;this.builder=i;this.merchant=n;this.innovator=r;this.banker=e;this.intuitiveType=this.builder+this.merchant;this.independentType=this.builder+this.innovator;this.practicalType=this.builder+this.banker;this.creativeType=this.merchant+this.innovator;this.communityType=this.merchant+this.banker;this.cognitiveType=this.innovator+this.banker}toString(){return"CVI[{0}: {1}, {2}, {3}, {4} ]".format(this.name,this.builder,this.merchant,this.innovator,this.banker)}builderPoint(){return new t(-this.builder,-this.builder)}merchantPoint(){return new t(this.merchant,-this.merchant)}innovatorPoint(){return new t(this.innovator,this.innovator)}bankerPoint(){return new t(-this.banker,this.banker)}builderBankerLine(){return new i(this.builderPoint(),this.bankerPoint())}merchantBuilderLine(){return new i(this.merchantPoint(),this.builderPoint())}innovatorMerchantLine(){return new i(this.innovatorPoint(),this.merchantPoint())}bankerInnovatorLine(){return new i(this.bankerPoint(),this.innovatorPoint())}builderPoints(){return[this.merchantBuilderLine().yIntercept(),this.builderPoint(),this.builderBankerLine().xIntercept()]}merchantPoints(){return[this.merchantBuilderLine().yIntercept(),this.merchantPoint(),this.innovatorMerchantLine().xIntercept()]}innovatorPoints(){return[this.innovatorMerchantLine().xIntercept(),this.innovatorPoint(),this.bankerInnovatorLine().yIntercept()]}bankerPoints(){return[this.bankerInnovatorLine().yIntercept(),this.bankerPoint(),this.builderBankerLine().xIntercept()]}}n.maxScore=30;class r extends n{constructor(t,i){var n,r=0,e=0,o=0,s=0;for(n in i){var h=i[n];s+=h.builder;e+=h.merchant;r+=h.innovator;o+=h.banker}super(t,s/i.length,e/i.length,r/i.length,o/i.length);this.profiles=i}}class e{constructor(i){this.svgDivID=i;var r=document.getElementById(i);while(r.childElementCount>0)r.removeChild(r.firstChild);this.svg=SVG(i).size(700,700);this.scale=this.svg.width()/2/n.maxScore;this.origin=new t(this.svg.width()/2,this.svg.height()/2)}merchantQuadrantInfo(){return{quadrant:[1,-1],points:[],title:"Merchant","core-value":"Love","fill-colour":[e.merchantLightColour,e.merchantDarkColour],"title-location":[.9,.05]}}innovatorQuadrantInfo(){return{quadrant:[1,1],points:[],title:"Innovator","core-value":"Wisdom","fill-colour":[e.innovatorLightColour,e.innovatorDarkColour],"title-location":[.9,.95]}}bankerQuadrantInfo(){return{quadrant:[-1,1],points:[],title:"Banker","core-value":"Knowledge","fill-colour":[e.bankerLightColour,e.bankerDarkColour],"title-location":[.1,.95]}}builderQuadrantInfo(){return{quadrant:[-1,-1],points:[],title:"Builder","core-value":"Power","fill-colour":[e.builderLightColour,e.builderDarkColour],"title-location":[.1,.05]}}_get_quadrants(t){var i,n,r;var e=[this.builderQuadrantInfo(),this.merchantQuadrantInfo(),this.innovatorQuadrantInfo(),this.bankerQuadrantInfo()];if(!t)return e;e[0].points=t.builderPoints();e[1].points=t.merchantPoints();e[2].points=t.innovatorPoints();e[3].points=t.bankerPoints();for(i in e){r=e[i].points;for(n in r){r[n].setOrigin(this.origin.x(),this.origin.y());r[n].setScale(this.scale)}}return e}renderQuandrantBackgrounds(){var t,i,n,r,o,s;var h=e.quadrantBackgroundColour;var a=this._get_quadrants(null);for(t in a){i=a[t].quadrant;o=this.svg.width()/2;s=this.svg.height()/2;n=0;if(i[0]>0)n=o;r=0;if(i[1]>0)r=s;this.svg.rect(o,s).move(n,r).fill(h)}}renderTextLayer(t){var i,n;var r=".cviCanvas.quadrant-background-colour";var e=this._get_quadrants(null);var o,s,h,a;for(i in e){n=e[i];a=n["title"].toLowerCase();h=n["title"]+" ";if(Number.isInteger(t[a]))h+=t[a];else h+=t[a].toFixed(2);o=this.svg.width()*n["title-location"][0];s=this.svg.height()*n["title-location"][1];this.svg.text(h).move(o,s-10).fill("black").font({family:"Arial",size:"20px",anchor:"middle"});this.svg.text("["+n["core-value"]+"]").move(o,s+10).fill("black").font({family:"Arial",size:"16px",anchor:"middle"})}}renderReferencePoints(t){var i,n;for(i in t){n=t[i];this.svg.circle(4).move(n.x()-2,n.y()-2).fill("black")}}renderPolygon(t,i){var n,r,o;n=this.svg.gradient("linear",function(i){i.at(0,t["fill-colour"][0]);i.at(1,t["fill-colour"][1])});if(t["quadrant"][0]>0&&t["quadrant"][1]>0)n.from(0,0).to(1,1);else if(t["quadrant"][0]>0&&t["quadrant"][1]<0)n.from(0,1).to(1,0);else if(t["quadrant"][0]<0&&t["quadrant"][1]>0)n.from(1,0).to(0,1);else n.from(1,1).to(0,0);var s=[[this.svg.width()/2,this.svg.height()/2]];for(r in t["points"]){o=t["points"][r];s.push([o.x(),o.y()])}this.svg.polygon(s).fill(n);if(i){this.svg.line(t["points"][0].x(),t["points"][0].y(),t["points"][1].x(),t["points"][1].y()).stroke({width:3,color:e.borderColour});this.svg.line(t["points"][1].x(),t["points"][1].y(),t["points"][2].x(),t["points"][2].y()).stroke({width:3,color:e.borderColour})}}render(t){var i,e,o,s;var h,a;var l;if(t instanceof r){console.log("Render(): Is a CVIGroupProfile");a=[];for(i in t.profiles)a.push(t.profiles[i]);a.push(t);l=t}else if(t instanceof n){console.log("Render(): Is a CVIProfile");a=[];l=t}else{console.log("Render(): received list");l=t.shift();a=t}this.renderQuandrantBackgrounds();for(i in a){h=a[i];console.log("Rendering: "+h.name);o=this._get_quadrants(h);for(e in o){s=o[e];this.renderPolygon(s,false);this.renderReferencePoints(s["points"])}}var u=a.length!=0;o=this._get_quadrants(l);for(e in o){s=o[e];this.renderPolygon(s,u);this.renderReferencePoints(s["points"])}this.renderTextLayer(l);this.renderCoordinateLines()}renderCoordinateLines(){this.svg.line(this.svg.width()/2,0,this.svg.width()/2,this.svg.height()).stroke({width:6,color:"white"});this.svg.line(0,this.svg.height()/2,this.svg.width(),this.svg.height()/2).stroke({width:6,color:"white"})}}e.quadrantBackgroundColour="#E6E6E6";e.merchantLightColour="#D5DDEC";e.merchantDarkColour="#345AA3";e.innovatorLightColour="#F6DCFB";e.innovatorDarkColour="#D55EEA";e.bankerLightColour="#C1DCBF";e.bankerDarkColour="#32842D";e.builderLightColour="#FBC9C8";e.builderDarkColour="#F03230";e.borderColour="#afafaf";function cvi(t){var i=new n("Mark Nicholson",14,21,29,8);var o=new n("Karen Nicholson",16,29,14,13);var s=new r("Nicholsons",[i,o]);var h;if(t=="karen")h=o;else if(t=="mark")h=i;else h=s;var a=new e("cviCanvas");a.render(h);return}var cviRender=null;function cviTool(t,i){if(!i||i.length==0)return;cviRender=new e("svgDivID");var o=[];for(var s in i){console.log(i[s]);var h=new n(i[s][0],i[s][1],i[s][2],i[s][3],i[s][4]);o.push(h)}if(o.length==1){cviRender.render(o[0]);return}var a=new r(t,o);cviRender.render(a)}class o{constructor(){this.cons_var=2}}o.myStaticProperty="yes";function cvi_test(){var t="15";var i;var n=new o;console.log("con_var: "+n.cons_var);console.log("staticProp: "+o.myStaticProperty)}
